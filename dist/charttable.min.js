!function(f){"object"==typeof exports&&"undefined"!=typeof module?module.exports=f():"function"==typeof define&&define.amd?define([],f):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).charttable=f()}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var p="function"==typeof require&&require;if(!f&&p)return p(i,!0);if(u)return u(i,!0);throw(p=new Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",p}p=n[i]={exports:{}},e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){exports.table=function(){var gData=null,gSelectedCol={},gSelectedRow={},gColors=null,gMinSelectedRow2Show=null,gMinSelectedCol2Show=null,gOnSelect=null;function prepareSelectedData(){if(!(Object.keys(gSelectedCol).length==gMinSelectedCol2Show&&Object.keys(gSelectedRow).length>=gMinSelectedRow2Show))return{};var selectedDataSet=[];Object.entries(gData).forEach(function(key,value){value in gSelectedRow&&selectedDataSet.push(key)});for(var selectedColumnNames=[],i=0;i<gMinSelectedCol2Show;i++)selectedColumnNames.push(Object.keys(gSelectedCol)[i]);return{selectedRows:selectedDataSet,selectedColumns:selectedColumnNames}}function toggleTrainingDataSet(selected,id){("th"==selected.tagName.toLowerCase()?function(id){id in gSelectedCol?delete gSelectedCol[id]:gSelectedCol[id]=""}:function(id){id in gSelectedRow?delete gSelectedRow[id]:gSelectedRow[id]=""})(id)}function createSvgBarChart(title,maxCount,groups,cid){var yBase=maxCount.map(x=>x[title]),minVal=Math.min(...yBase),maxVal=Math.max(...yBase);const chunks=function(row,maxVal,minVal,groups){const range=(maxVal-minVal)/groups;for(var res=[],i=0;i<groups;i++)res.push({data:row.filter(function(x){return 0==i?x>=minVal+i*range&&x<=minVal+(i+1)*range:x>minVal+i*range&&x<=minVal+(i+1)*range}),lo:Math.round(100*(minVal+i*range))/100,hi:Math.round(100*(minVal+(i+1)*range))/100});return res}(yBase,maxVal,minVal,groups);maxCount=Math.max(...chunks.map(x=>x.data.length)),yBase=document.getElementsByClassName("tableFixHead")[0].offsetTop;return`<div><b>${title}</b></div>
      <div>${function(chunks,w,h,groups,maxCount,xBase,yBase){for(var html=`<svg class="customChart" width="${w}" height="${h}" style="fill: ${gColors[0]}"><g>`,width=(w-20)/groups,idx=0;idx<chunks.length;idx++){var item=chunks[idx],height=h*item.data.length/maxCount,x=10+width*idx,y=h-height;html+=`<rect onmousemove="mytable.barMouseMove(${xBase+x}, ${y-10+yBase}, '${`<b>${item.lo}-${item.hi}</b><br>count: <b>${item.data.length}</b>`}');" onmouseout="mytable.barMouseOut();" onmouseover="mytable.barMouseOver();" class="bar" x="${x}" width="${width}" y="${y}" height="${height}"></rect>`}return html+="</g></svg>"}(chunks,200,200,groups,maxCount,200*cid,yBase)}</div>
      <div>
        <div style="float: left;">${minVal}</div>
        <div style="float: right;">${maxVal}</div>
      </div>`}function createSvgPieChart(title,chunks){const row=chunks.map(x=>x[title]);chunks=row.reduce((total,curr)=>(total.hasOwnProperty(curr)||(total[curr]=[]),total[curr].push(curr),total),{});return`<div><b>${title}</b></div>
      <div>${function(chunks,w,h,total){var html=`<svg class="customChart" width="${w}" height="${h}" viewBox="0 0 32 32"><g>`,currCount=0,i=0;return html+='<circle r="16" cx="16" cy="16" style="fill:gray;" />',Object.entries(chunks).forEach(([,item])=>{dasharrayValue=(total-currCount)/parseFloat(total)*100,html+=`<circle r="8" cx="16" cy="16" style="stroke:${gColors[i]};stroke-dasharray:calc(${dasharrayValue} * 31.42px / 62.5) ${dasharrayValue}px" class="pieChartCircle"></circle>`,i+=1,currCount+=item.length}),html+="</g></svg>"}(chunks,200,200,row.length)}</div>`}function createElementHelper(tag,content,attr=null,func=null){tag=document.createElement(tag);return tag.innerHTML=content,null!=attr&&null!=func&&tag.setAttribute(attr,func),tag}function emptyChild(ele){for(;ele.firstChild;)ele.removeChild(ele.firstChild)}let publicScope={};return publicScope.initTbl=function(ele,options){options=function(a,b){for(var key in b)b.hasOwnProperty(key)&&(a[key]=b[key]);return a}({columnTypes:[],colors:["#FFB000","#DC267F","#648FFB","#785EF0"],minSelectedRow2Show:3,minSelectedCol2Show:2,height:360,onSelect:null},options),options.columnTypes,gColors=options.colors,gMinSelectedRow2Show=options.minSelectedRow2Show,gMinSelectedCol2Show=options.minSelectedCol2Show,gOnSelect=options.onSelect,gHeight=options.height,ele.innerHTML=`
      <span class="tooltiptext">Tooltip text</span>
      <div class="tableFixHead" style="height: ${gHeight}px;">
        <table>
          <thead>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>`},publicScope.showDataset=function(data){gData=data;var thead=document.querySelector(".tableFixHead > table > thead");emptyChild(thead);const numberOfColumns=Object.keys(data[0]).length;var i=0,tr=document.createElement("tr");Object.entries(data[0]).forEach(([key,value])=>{i==numberOfColumns-1?tr.append(createElementHelper("th",createSvgPieChart(key,data))):isNaN(value)?tr.append(createElementHelper("th",createSvgPieChart(key,data),"onclick",`mytable.selectMe(this, '${key}');`)):tr.append(createElementHelper("th",createSvgBarChart(key,data,10,i),"onclick",`mytable.selectMe(this, '${key}');`)),i++}),thead.append(tr);var tbody=document.querySelector(".tableFixHead > table > tbody");emptyChild(tbody),Object.entries(data).forEach(([key,item])=>{var tr=document.createElement("tr");tr.setAttribute("onclick",`mytable.selectMe(this, '${key}');`),Object.entries(item).forEach(([,value])=>{tr.append(createElementHelper("td",value))}),tbody.append(tr)})},publicScope.selectMe=function(selected,id){selected.classList.contains("trainingdata")?(selected.classList.remove("trainingdata"),toggleTrainingDataSet(selected,id)):function(selected){return"th"!=selected.tagName.toLowerCase()||Object.keys(gSelectedCol).length!=gMinSelectedCol2Show}(selected)&&(selected.classList.add("trainingdata"),toggleTrainingDataSet(selected,id)),gOnSelect&&gOnSelect(prepareSelectedData())},publicScope.barMouseMove=function(x,y,content){document.querySelector(".tooltiptext").style.top=`${y}px`,document.querySelector(".tooltiptext").style.left=`${x}px`,document.querySelector(".tooltiptext").innerHTML=content},publicScope.barMouseOver=function(){document.querySelector(".tooltiptext").style.visibility="visible"},publicScope.barMouseOut=function(){document.querySelector(".tooltiptext").style.visibility="hidden"},publicScope}},{}]},{},[1])(1)});
